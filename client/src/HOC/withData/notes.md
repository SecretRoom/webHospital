НОС withData

Это декоратор, который оборачивает компонент и реализует логику по загрузке данных, отображению загрузчика и отмене запроса в случае размонтирования компонента.

Использование.

1. Реaлизуйте свой компонент с учетом того, что данные, которые вам нужно запросить с сервера, придут из свойств (props) в объекте data.

2. При экспорте своего компонента оборачивайте его в декоратор withData, предварительно импортировав его из src/HOC/withData:

   ```js
   import withData from '../HOC/withData'
   
   // Реализация вашего компонента
   
   export default withData(YourComponent)
   ```

   

3. Теперь при использовании компонента передаем ему метод для загрузки данных в свойство (props) fetchData, так как, по сути, это callback, то он первым аргументом получит токен отмены cancelToken, его можете использовать в своем API методе как описано [тут](http://192.168.0.204:8090/KohanovAS/webMisEM/wikis/%D0%9E%D1%82%D0%BC%D0%B5%D0%BD%D0%B0-%D0%B0%D1%81%D0%B8%D0%BD%D1%85%D1%80%D0%BE%D0%BD%D0%BD%D1%8B%D1%85-%D0%BE%D0%BF%D0%B5%D1%80%D0%B0%D1%86%D0%B8%D0%B9-%D0%B8-%D0%BE%D1%82%D0%BF%D0%B8%D1%81%D0%BA%D0%B0-%D0%BE%D1%82-%D0%BF%D0%BE%D0%B4%D0%BF%D0%B8%D1%81%D0%BE%D0%BA-%D0%BF%D1%80%D0%B8-%D1%80%D0%B0%D0%B7%D0%BC%D0%BE%D0%BD%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B8-%D0%BA%D0%BE%D0%BC%D0%BF%D0%BE%D0%BD%D0%B5%D0%BD%D1%82%D0%BE%D0%B2)
   ```jsx
   const getData = (cancelToken) => {
       data = {
          // Данные, необходимые для запроса
       }
       API.yourAPIMethod(data)
   }
   
   <YourComponent 
       fetchData={getData} // Данное свойство попадет в декоратор и загрузит данные
    // Остальные свойства для вашего компонента если необходимо
   />
   ```

4. Также декоратор поддерживает параметр для отображения загрузчика, который можно ему передать(по умолчанию отобразит <Segment placeholder loading />,), если это необходимо:

   ```jsx
   <YourComponent 
       fetchData={getData} // Данное свойство попадет в декоратор - загрузит данные
       loading // Данное свойство попадет в декоратор - отобразит загрузчик
       loader // Компонент загрузчика, по умалчанию <Segment placeholder loading />
       // Остальные свойства для вашего компонента если необходимо
   />
   ```

   Если хотите использовать свой загрузчик или логику по отображению, то loading указывать не надо, в props передается свойство isFetching. Для isFetching начальное значение true, во время загрузки данных - true, при успешном/не успешном запросе - false.

5. Если необходим повторный вызов API метода для получения данных с сервера в вашем компоненте, например, обновить данные после какого-то действия, то в компонент передается props onFetch, который можно вызвать в любом месте вашего компонента, произойдет запрос на сервер и props data обновится:

   ```js
   this.props.onFetch()
   ```


Для использования с другими декораторами можете воспользоваться функцией compose из redux:

```jsx
import { compose } from 'redux'
import withData from '../HOC/withData'
import accessCheck from '../HOC/accessCheck'

// Реализация вашего компонента

export default compose(
    withData,
    accessCheck,
)(YourComponent)

```





Это избавит от написания шаблонного кода по получению данных с сервера.

